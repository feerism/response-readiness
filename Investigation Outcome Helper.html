<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Investigation Outcome Helper</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:#0b1220;color:#e5e7eb;margin:0;padding:24px}
  h1{font-size:20px;margin:0 0 8px}
  p{margin:0 0 16px;color:#9ca3af;font-size:13px}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px 18px;max-width:720px;margin-bottom:20px}
  label{display:flex;flex-direction:column;font-size:12px;color:#9ca3af;gap:4px}
  select{padding:6px 8px;border-radius:6px;border:1px solid #4b5563;background:#020817;color:#e5e7eb;font-size:13px}
  select:disabled{opacity:.5;cursor:not-allowed}
  .hidden{display:none}
  .outcome-box{max-width:720px;padding:12px 14px;border-radius:8px;background:#111827;border:1px solid #374151;font-size:13px}
  .outcome-label{font-size:11px;color:#6b7280;text-transform:uppercase;letter-spacing:.08em;margin-bottom:4px}
  .outcome-value{font-size:15px;font-weight:600;color:#38bdf8;margin-bottom:6px}
  .outcome-details{margin:0;padding-left:18px;color:#9ca3af;font-size:12px}
</style>
</head>
<body>

<h1>Investigation Outcome Helper</h1>
<p>"Alert configuration correct" is mandatory. Other fields support Yes / No / Not sure. No hyphens in outcomes.</p>

<div class="grid">
  <label>
    Alert configuration correct
    <select id="alertCfg">
      <option value="">Select</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
      <option value="NotSure">Not sure</option>
    </select>
  </label>

  <label>
    Activity expected
    <select id="activityExp">
      <option value="">Select</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
      <option value="NotSure">Not sure</option>
    </select>
  </label>

  <label>
    Threat mitigated
    <select id="threatMit">
      <option value="">Select</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
      <option value="NotSure">Not sure</option>
    </select>
  </label>

  <label>
    Cybersecurity impact
    <select id="impact">
      <option value="">Select</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
      <option value="NotSure">Not sure</option>
    </select>
  </label>

  <!-- These two rows are conditionally visible based on Activity expected -->
  <label id="row-fineTune" class="hidden">
    Fine tuning required
    <select id="fineTune">
      <option value="">Select</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
      <option value="NotSure">Not sure</option>
    </select>
  </label>

  <label id="row-secTest" class="hidden">
    Internal security testing
    <select id="secTest">
      <option value="">Select</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
      <option value="NotSure">Not sure</option>
    </select>
  </label>
</div>

<div class="outcome-box">
  <div class="outcome-label">Investigation outcome</div>
  <div id="outcome" class="outcome-value">Waiting for inputs</div>
  <ul id="details" class="outcome-details"></ul>
</div>

<script>
  const ids = {
    A:"alertCfg", B:"activityExp", C:"threatMit", D:"impact", E:"fineTune", F:"secTest"
  };
  const optFine = document.getElementById("row-fineTune");
  const optTest = document.getElementById("row-secTest");

  Object.values(ids).forEach(id=>{
    document.getElementById(id).addEventListener("change", handleChange);
  });

  function v(id){ return (document.getElementById(id).value || "").trim(); }
  function setVal(id, value){ const el=document.getElementById(id); el.value=value; }
  function disableList(list, disabled, clear){
    list.forEach(id=>{
      const el = document.getElementById(id);
      el.disabled = disabled;
      if (clear){ el.value = ""; }
    });
  }
  function showRows(show){
    optFine.classList.toggle("hidden", !show);
    optTest.classList.toggle("hidden", !show);
    if (!show){
      setVal(ids.E,"");
      setVal(ids.F,"");
    }
  }
  function setDetails(items){
    const list = document.getElementById("details");
    list.innerHTML = "";
    (items || []).forEach(t=>{
      const li = document.createElement("li");
      li.textContent = t;
      list.appendChild(li);
    });
  }
  // Treat No / NotSure / blank as "No-group" for non-mandatory fields
  function isNoGroup(val){ return val === "No" || val === "NotSure" || val === ""; }

  function handleChange(){
    // --- UI state rules ---
    const A = v(ids.A);
    const B = v(ids.B);

    // If Alert config = No → disable others (and clear)
    if (A === "No"){
      disableList([ids.B,ids.C,ids.D,ids.E,ids.F], true, true);
      // Also hide fine tuning & security testing rows
      showRows(false);
    } else {
      // Enable others
      disableList([ids.B,ids.C,ids.D,ids.E,ids.F], false, false);
      // Toggle fine tuning & security testing visibility based on Activity expected
      if (B === "Yes"){
        showRows(true);
      } else {
        showRows(false);
      }
    }

    // --- Outcome logic ---
    updateOutcome();
  }

  function updateOutcome(){
    const A = v(ids.A); // mandatory
    const B = v(ids.B);
    const C = v(ids.C);
    const D = v(ids.D);
    const E = v(ids.E);
    const F = v(ids.F);

    let outcome = "";
    let bullets = [];

    // Mandatory selection for A
    if (A === ""){
      const anyOther = [B,C,D,E,F].some(x=>x!=="");
      outcome = anyOther ? "Please select whether alert configuration is correct" : "Waiting for inputs";
      bullets = (A==="") ? ["Alert configuration correct is mandatory"] : [];
      document.getElementById("outcome").textContent = outcome;
      setDetails(bullets);
      return;
    }

    // If A = No → auto False Positive (others are disabled anyway)
    if (A === "No"){
      outcome = "False Positive";
      bullets = [
        "Alert configuration confirmed incorrect",
        "Treat as configuration or tuning issue",
        "No validated cybersecurity impact from this alert logic"
      ];
    }
    // If A = Not sure → TP No Impact No Control Failure
    else if (A === "NotSure"){
      outcome = "True Positive No Impact No Control Failure";
      bullets = [
        "Alert logic appears to function but confirmation pending",
        "Threat handled or contained",
        "No confirmed impact and no control failure recorded"
      ];
    }
    // A = Yes → evaluate full matrix
    else if (A === "Yes" && isNoGroup(B) && C === "Yes" && isNoGroup(D)){
      outcome = "True Positive No Impact No Control Failure";
      bullets = [
        "Unauthorized or malicious activity detected",
        "Threat mitigated",
        "No confirmed cybersecurity impact",
        "Controls and response adequate"
      ];
    }
    else if (A === "Yes" && isNoGroup(B) && C === "Yes" && D === "Yes"){
      outcome = "True Positive Impact";
      bullets = [
        "Unauthorized or malicious activity confirmed",
        "Threat mitigated or contained",
        "Cybersecurity impact confirmed"
      ];
    }
    else if (A === "Yes" && isNoGroup(B) && isNoGroup(C) && isNoGroup(D)){
      outcome = "True Positive No Impact Control Failure";
      bullets = [
        "Unauthorized or malicious activity confirmed",
        "No confirmed impact",
        "Required controls or response actions did not execute as expected"
      ];
    }
    else if (A === "Yes" && B === "Yes" && isNoGroup(E) && isNoGroup(F)){
      outcome = "Benign True Positive";
      bullets = [
        "Alert logic is correct",
        "Activity is expected and approved",
        "No tuning or special handling required"
      ];
    }
    else if (A === "Yes" && B === "Yes" && E === "Yes" && isNoGroup(F)){
      outcome = "Benign True Positive Fine Tuning Suppression";
      bullets = [
        "Alert logic is correct",
        "Activity is expected",
        "Pattern suitable for tuning or suppression"
      ];
    }
    else if (A === "Yes" && B === "Yes" && F === "Yes" && isNoGroup(E)){
      outcome = "Benign True Positive Internal Security Testing";
      bullets = [
        "Alert logic is correct",
        "Activity linked to approved internal testing",
        "No malicious intent or impact"
      ];
    }
    else {
      outcome = "Check inputs no standard outcome matched";
      bullets = [
        "Review selections manually",
        "Outcome does not fit standard patterns"
      ];
    }

    document.getElementById("outcome").textContent = outcome;
    setDetails(bullets);
  }

  // init
  handleChange();
</script>
</body>
</html>
